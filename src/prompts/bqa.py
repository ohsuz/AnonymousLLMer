def input_finance_bqa_complex_question(passage):
    system_prompt = """너는 문서를 보고 궁금한 질문을 생성해내는 질문자야. 문서가 없이 질문을 하기 위해서, 문서의 내용을 발췌하여 질문을 생성해야해. 
웹에서 가져온 문서를 기반으로 모델 학습용 질문을 생성하는것이 과제입니다. 형식, 간결성, 완전성, 정확성 및 일관성에 중점을 두어 모델학습 목적에 맞게 품질을 향상시키는 것이 목표입니다. 다음 가이드라인을 준수하세요:

1. 일관성 및 간결성:
- 흐름과 일관성을 개선하기 위해 질문이 논리적이고 따라가기 쉽도록 합니다.
- 콘텐츠를 간결하게 만드세요. 중복되는 정보는 제거하되, 질문을 이해하는 데 필요한 중요한 세부 정보가 삭제되지 않도록 주의하세요.

2. 완전성:
- 질문이 시험 또는 탐구하려는 개념을 완전히 파악하고 있는지 평가합니다. 누락된 문맥이나 세부 사항을 문제에 추가하여 문제를 더 명확하고 일반적으로 만들 수 있습니다.

3. 답변가능성:
- 질문은 문서없이도 답변할수 있도록 문서의 내용을 포함하여 상세히 작성하여, 문서가 없이도 질문에 답변을 할 수 있게 상세히 질문해야합니다.

수정한 내용은 궁극적으로 체계적이고 명확하며 정확하고 교과서 수준의 교육 자료와 유사한 콘텐츠가 되어야 합니다. 질문을 생성하세요.
아래는 [문서]를 기반으로 [질문]을 생성한 예시를 보여줍니다.

[문서 1]
# ESG 투자란 무엇인가? 

ESG 투자는 환경(Environmental), 사회(Social), 지배구조(Governance)를 고려한 투자 방식으로, 기업의 재무적 성과뿐만 아니라 지속 가능성과 사회적 책임을 중시하는 투자 전략입니다. ESG 투자는 단순히 윤리적인 투자 방법으로 여겨지던 초기 개념을 넘어, 오늘날에는 장기적인 리스크 관리와 가치 창출의 관점에서 주류 투자 전략으로 자리 잡았습니다.

---
## 1. ESG의 세 가지 주요 요소

### 1.1 환경(Environmental)
- 기업이 환경 보호를 위해 얼마나 노력하는지를 평가합니다.
- **평가 요소**: 탄소 배출량, 에너지 효율성, 자원 사용, 재생 가능 에너지 활용, 폐기물 관리 등.
- **사례**: 친환경 에너지로 전환하는 기업, 환경 오염 방지 기술 개발 기업.

### 1.2 사회(Social)
- 기업이 직원, 고객, 지역사회 등 다양한 이해관계자들과의 관계를 어떻게 관리하는지를 중점적으로 살핍니다.
- **평가 요소**: 노동권 보호, 다양성 및 포용성, 소비자 보호, 지역사회 공헌.
- **사례**: 공정한 근로 환경을 제공하거나, 지역사회를 지원하는 기업.

### 1.3 지배구조(Governance)
- 기업의 경영 투명성과 윤리적 경영 관행을 평가합니다.
- **평가 요소**: 이사회 구조, 반부패 정책, 주주 권리 보호, 경영진의 책임감.
- **사례**: 독립적인 이사회 구성, 투명한 재무보고를 유지하는 기업.

---

## 2. ESG 투자 방법

1. **네거티브 스크리닝(Negative Screening)**  
   - 윤리적으로 문제가 있는 산업(예: 담배, 도박, 석탄 산업 등)을 투자 대상에서 제외.
   
2. **포지티브 스크리닝(Positive Screening)**  
   - ESG 성과가 우수한 기업이나 산업에 적극적으로 투자.

3. **테마 투자(Thematic Investing)**  
   - 친환경 에너지, 지속 가능한 농업, 기후 변화 대응 등 특정 ESG 주제에 맞춘 투자.

4. **임팩트 투자(Impact Investing)**  
   - 재무적 수익과 함께 사회적 또는 환경적 영향을 목표로 한 투자.

---

## 3. ESG 투자의 장점

1. **리스크 관리**  
   - ESG 요소를 고려하면 환경적 사고, 규제 위반, 기업 평판 리스크를 줄일 수 있습니다.
   
2. **장기적 수익성**  
   - 지속 가능한 경영을 추구하는 기업은 장기적으로 더 안정적이고 높은 수익을 창출할 가능성이 높습니다.
   
3. **사회적 책임**  
   - 투자자는 자신의 자금이 긍정적인 사회적 변화를 촉진하는 데 사용된다는 점에서 만족감을 얻을 수 있습니다.
   
[질문 1]   
Q. 한국의 주식 시장에서 최근 ESG 투자 트렌드가 증가하고 있는 가운데, 특정 산업군(예: 화석 연료 산업)과 관련된 기업에 대한 투자 결정 시 고려해야 할 ESG 요소는 무엇이며, 이러한 결정이 해당 기업의 장기적인 재무 성과에 미치는 영향은 어떻게 평가할 수 있을까요?

[문서 2]
상법 제628조 제1항 소정의 납입가장죄는 회사의 자본충실을 기하려는 법의 취지를 유린하는 행위를 단속하려는 데 그 목적이 있는 것이므로, 당초부터 진실한 주금납입으로 회사의 자금을 확보할 의사 없이 형식상 또는 일시적으로 주금을 납입하고 이 돈을 은행에 예치하여 납입의 외형을 갖추고 주금납입증명서를 교부받아 설립등기나 증자등기의 절차를 마친 다음 바로 그 납입한 돈을 인출한 경우에는, 이를 회사를 위하여 사용하였다는 특별한 사정이 없는 한 실질적으로 회사의 자본이 늘어난 것이 아니어서 납입가장죄 및 공정증서원본불실기재죄와 불실기재공정증서원본행사죄가 성립하고, 다만 납입한 돈을 곧바로 인출하였다고 하더라도 그 인출한 돈을 회사를 위하여 사용한 것이라면 자본충실을 해친다고 할 수 없으므로 주금납입의 의사 없이 납입한 것으로 볼 수는 없다 ( 대법원 1997. 2. 14. 선고 96도2904 판결 등 참조).

1. 상법
제628조 (주금납입의 의무): 상법 제628조는 주금납입의 의무를 규정하고 있습니다. 회사 설립이나 증자 시 주금을 납입해야 하는 의무가 있으며, 이는 회사의 자본충실을 위해 중요합니다. 위의 사례에서는 전환사채 발행이지만, 주금납입과 유사한 개념으로 해석될 수 있습니다.
제533조 (증권발행의 절차): 증권 발행 시 필요한 절차와 공시 요구사항을 규정하고 있습니다. 전환사채 발행 역시 이 절차를 준수해야 합니다.
2. 금융투자업에 관한 법률
제141조 (증권신고서 제출의 의무): 증권 발행 시 증권신고서를 금융감독원에 제출해야 합니다. 이는 투자자 보호와 시장의 투명성을 위해 필요합니다.
제152조 (공시의 의무): 증권 발행 후 지속적인 정보 공시 의무가 있습니다. 특히, 중요한 계약이나 거래 내용이 변경되었을 경우 즉시 공시해야 합니다.
3. 외국환거래법
제10조 (외국환거래의 신고): 외국인 투자자의 자금 유입 및 유출 시 외국환거래 신고가 필요합니다. 이는 외국환 거래의 투명성과 안정성을 위해 필요합니다.
제11조 (외국환거래의 승인): 특정 규모 이상의 외국환 거래는 금융감독원의 승인이 필요할 수 있습니다.

[질문 2]
Q. 상장회사가 해외투자자를 대상으로 해외에서 전환사채를 공모하면서, 최초 인수자인 해외투자자와 내국인이 해당 채권을 재매수하기로 이면계약을 체결한 경우, 이러한 거래에 적용되는 법률은 무엇인지 설명하고, 이로 인해 발생하는 의무들을 검토하시요.

[문서 3]
# **포트폴리오 분산 공식과 최적화**  

## **1. 개요**  
포트폴리오 이론의 핵심은 투자 자산 간 상관관계를 활용하여 분산 투자 효과를 극대화하고, 이를 통해 전체 포트폴리오의 위험을 최소화하는 것입니다. 포트폴리오의 분산 공식은 각 자산의 변동성과 상관계수, 그리고 자산의 포트폴리오 내 비중에 따라 결정됩니다.  

---

## **2. 포트폴리오 분산 공식**  

포트폴리오의 분산(\\(\sigma_p^2\\))은 다음과 같이 계산됩니다:  
\\[
\sigma_p^2 = w_1^2 \sigma_1^2 + w_2^2 \sigma_2^2 + 2w_1w_2\sigma_1\sigma_2\rho
\\]  
여기서:  
- \\(\sigma_p^2\\): 포트폴리오의 분산  
- \\(w_1, w_2\\): 각각 자산 1과 자산 2의 포트폴리오 내 비중  
- \\(\sigma_1, \sigma_2\\): 각각 자산 1과 자산 2의 표준편차  
- \\(\rho\\): 자산 1과 자산 2 간의 상관계수  

### **포트폴리오의 표준편차**  
분산의 제곱근을 계산하여 포트폴리오의 표준편차(\\(\sigma_p\\))를 얻습니다:  
\\[
\sigma_p = \sqrt{\sigma_p^2}
\\]

---

## **3. 포트폴리오 위험 최소화 조건**  

### **3.1 상관계수의 역할**  
상관계수 \\(\rho\\)는 자산 간의 관계를 나타내며, 그 값의 범위는 \\(-1 \leq \rho \leq 1\\)입니다.  
- \\(\rho = -1\\): 두 자산이 완벽히 반대 방향으로 움직임 → 위험 완전 상쇄 가능  
- \\(\rho = 0\\): 두 자산이 서로 독립적으로 움직임 → 분산 효과 극대화  
- \\(\rho = 1\\): 두 자산이 완전히 같은 방향으로 움직임 → 위험 감소 효과 없음  

### **3.2 최적 비중 계산**  
포트폴리오의 위험을 최소화하기 위해 각 자산의 최적 비중을 계산합니다. 최적 비중은 다음과 같습니다:  

#### **3.2.1 자산 1의 비중 (\\(w_1^*\\)):**
\\[
w_1^* = \frac{\sigma_2^2 - \rho \sigma_1 \sigma_2}{\sigma_1^2 + \sigma_2^2 - 2\rho \sigma_1 \sigma_2}
\\]

#### **3.2.2 자산 2의 비중 (\\(w_2^*\\)):**
\\[
w_2^* = 1 - w_1^*
\\]  

---

## **4. 예시: 두 자산 포트폴리오**  

### **주어진 조건:**  
- 자산 1의 표준편차: \\(\sigma_1 = 5\%\\)  
- 자산 2의 표준편차: \\(\sigma_2 = 10\%\\)  
- 두 자산 간 상관계수: \\(\rho = -1, 0, 1\\)  

### **계산 결과:**  
#### \\(\rho = -1\\):  
\\[
w_1^* = \frac{0.10^2 - (-1)(0.05)(0.10)}{0.05^2 + 0.10^2 - 2(-1)(0.05)(0.10)} \approx 0.667
\\]
\\[
w_2^* = 1 - w_1^* = 0.333
\\]

#### \\(\rho = 0\\):  
\\[
w_1^* = \frac{0.10^2 - (0)(0.05)(0.10)}{0.05^2 + 0.10^2 - 2(0)(0.05)(0.10)} = 0.8
\\]
\\[
w_2^* = 1 - w_1^* = 0.2
\\]

#### \\(\rho = 1\\):  
\\[
w_1^* = \frac{0.10^2 - (1)(0.05)(0.10)}{0.05^2 + 0.10^2 - 2(1)(0.05)(0.10)} = 2.0
\\]  
\\(w_1^* > 1\\)이므로 현실적인 투자에서는 \\(w_1 = 1, w_2 = 0\\)로 조정됩니다.

---

## **5. 결론**  
1. 포트폴리오 분산 공식은 투자 자산 간의 상관관계와 변동성을 활용하여 포트폴리오의 위험을 정량적으로 측정합니다.  
2. 상관계수가 낮을수록 분산 효과가 커지며, 위험 최소화에 유리합니다.  
3. 최적 비중을 계산할 때, 계산된 비중이 제약 조건(\\(w_1, w_2 \geq 0\\))을 만족하지 않는 경우 현실적인 비중으로 조정해야 합니다.

[질문 3]
Q. 두 주식의 표준편차가 각각 5%와 10%일 때, 이 두 주식의 공분산을 바탕으로 포트폴리오의 위험을 최소화하기 
위해 필요한 상관계수의 범위를 제시하고, 각 상관계수에 따른 최적 포트폴리오 비중을 계산하는 방법을 설명하시오.

[문서 4]
"""
    return str(system_prompt)+ passage

def input_finance_bqa_cq_answer(question, passage):
    system_prompt = """너는 문서를 보고 궁금한 질문에 답변하는 전문가야.
웹에서 가져온 문서를 기반으로 모델 학습용 전문가 답변을 생성하는것이 과제입니다. 형식, 간결성, 완전성, 정확성 및 일관성에 중점을 두어 모델학습 목적에 맞게 품질을 향상시키는 것이 목표입니다. 다음 가이드라인을 준수하세요:

1. 일관성 및 간결성:
- 콘텐츠를 간결하게 만드세요. 중복되는 정보는 제거하되, 질문을 이해하는 데 필요한 중요한 세부 정보가 삭제되지 않도록 주의하세요.

2. 완전성:
- 답변이 완전한 해결책이나 설명을 제공하는지 확인합니다. 필요한 경우 단계, 설명 또는 정보를 답변에 추가하여 추론이나 내용의 공백을 메웁니다.

3. 정확성 확인 및 수정:
- 제공된 답의 정확성을 확인합니다. 
- 부정확한 부분이 발견되면 올바른 해결책으로 수정합니다. **답에 대해 확신이 있는 경우에만 수정하세요!

4. 답변가능성:
- 답변은 문서의 내용을 상세히 포함하여 설명 해야합니다.

수정한 내용은 궁극적으로 체계적이고 명확하며 정확하고 교과서 수준의 교육 자료와 유사한 콘텐츠가 되어야 합니다. [문서]를 참고하여 [질문]에 대해서 답변을 생성하세요.
"""
    prompt = system_prompt + "[질문]\n" + question + "[문서]\n" + passage
    return prompt

def input_finance_bqa_q_answer(question):
    return question

def input_finance_bqa_blend_question_answers(question, cq_answer, q_answer):
    system_prompt = """너는 [질문]에 대한 답변들을 보고 신뢰가능한 답변을 활용하여 최종 상세한 답변을 생성하는 봇이야. [질문]에 대한 2개의 답변 중 
- [답변1]은 문서의 내용을 기반으로 생성하여 신뢰할수 있는 답변
- [답변2]는 모델이 질문만 보고 생성한 답변이라 답변은 상세하지만 정보가 사실이 아닐 수 있어. 
따라서 정보는 [답변1]을 활용하되 [답변2]의 설명의 형태로 두 답변을 잘 조합하여 믿을수 있는 신뢰가능한 상세한 답변을 생성해줘.
"""
    prompt = system_prompt + "[질문]\n" + question + "[답변1]\n" + cq_answer + "[답변2]\n" + q_answer
    return prompt